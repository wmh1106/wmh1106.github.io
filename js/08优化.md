# 优化

- 如何加载（资源）更快
  - 静态资源的压缩，并合理合并
  - 静态资源缓存：通过连接名称控制缓存
  - 使用 CDN 让资源加载更快
  - 使用 SSR 服务端渲染，数据直接输出 HTML 中
- 如何渲染（页面）更快
  - CSS 放前面，JS 放后面
  - 懒加载（图片懒加载，下拉加载更多）
  - 减少 DOM 查询，对 DOM查询做缓存：存变量
  - 减少 DOM 操作，多个操作尽量合并在一起执行：例，合并 DOM 插入元素，先拼字符串，一次性插入
  - 事件节流
  - 尽早执行操作：DOMContentLoaded

---
## 压缩、合并原理

- 减少 HTTP 请求数量、减小请求资源的大小
  - html 压缩：空格、制表符、换行、注释
    - 使用 nodejs 提供的工具：`html-minifier`
    - 后端模板引擎渲染压缩
  - css：无效代码删除、css 语义合并
    - 使用 nodejs 提供的工具：`html-minifier`
  - js：无效字符删除、删注释、代码语义的缩减和优化、代码保护
    - 使用 nodejs 提供的工具：`html-minifier`

文件合并存在的问题：首屏渲染、缓存失效

所以：

- 公共库合并
- 不同页面的合并
- 见机行事、随机应变


请求时：

- dns 是否可以通过缓存减少 dns查询时间
- 网络请求的过程走最近的网络环境
- 相同静态资源是否可以缓存
- 能否减少 http 请求，减少请求资源大小
- 服务端渲染

cdn 跟主站域名不同，可以防止携带 cookie，这样省流量


## 图片的优化

图片类型：

- jpg 有损压缩、压缩率高、不支持透明
- png支持透明、浏览器兼容好
- webp 压缩程度更好、在 `ios webview`有兼容问题
- svg 矢量图，代码内嵌、相对小，图片延时相对简单的场景

CSS 雪碧图：

- 优点：减少 HTTP 请求数量
- 缺点：图片变大了

image inline

- 优点：减少 HTTP 请求数量（就是 base64格式的图片）
- 缺点：html 文件变大了

小图标

- iconfont
- svg